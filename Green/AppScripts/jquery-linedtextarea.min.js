(function(a){a.fn.linedtextarea=function(d){var b=a.extend({},a.fn.linedtextarea.defaults,d),c=function(c,d,a){while(c.height()-d<=0){if(a==b.selectedLine)c.append("<div class='lineno lineselect'>"+a+"</div>");else c.append("<div class='lineno'>"+a+"</div>");a++}return a};return this.each(function(){var g=1,d=a(this);d.css({resize:"none"});var h=d.outerWidth();d.wrap("<div class='linedtextarea'></div>");var l=d.parent().wrap("<div class='linedwrap' style='width:"+h+"px'></div>"),e=l.parent();e.prepend("<div class='lines' style='width:50px'></div>");var f=e.find(".lines");f.height(d.height()+6);f.append("<div class='codelines'></div>");var i=f.find(".codelines");g=c(i,f.height(),1);if(b.selectedLine!=-1&&!isNaN(b.selectedLine)){var o=parseInt(d.height()/(g-2)),p=parseInt(o*b.selectedLine)-d.height()/2;d[0].scrollTop=p}var n=f.outerWidth(),j=parseInt(e.css("border-left-width"))+parseInt(e.css("border-right-width"))+parseInt(e.css("padding-left"))+parseInt(e.css("padding-right")),k=h-j,m=h-n-j-20;d.width(m);e.width(k);d.scroll(function(){var b=a(this)[0],d=b.scrollTop,e=b.clientHeight;i.css({"margin-top":-1*d+"px"});g=c(i,d+e,g)});d.resize(function(){var b=a(this)[0];f.height(b.clientHeight+6)})})};a.fn.linedtextarea.defaults={selectedLine:-1,selectedClass:"lineselect"}})(jQuery);